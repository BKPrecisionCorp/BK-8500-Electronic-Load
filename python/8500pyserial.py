import serial

def cmd8500(cmd ):
    print("Command: ")
    printbuff(cmd)
    ser.write(cmd)
    resp = ser.read(26)
    print("Resp: ")
    printbuff(resp)
    
def printbuff(b):
    r=""
    for s in range(26):
        r+="|"
        r+=str(s)
        r+="-"
        r+=hex(b[s])
    print(r)

ser = serial.Serial()
ser.baudrate = 9600
ser.port = 'COM4'
print(ser)
ser.open()
print(ser.is_open)
#enable remote mode
cmd8500([0xaa,00,0x20,0x01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,0xcb])
cmd8500([0xaa,00,0x28,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,0xd2])
cmd8500([0xaa,00,0x21,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,0xcb])
cmd8500([0xaa,00,0x6a,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,0x14])
cmd8500([0xaa,00,0x28,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,0xd2])
cmd8500([0xaa,00,0x5d,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,0x07])
cmd8500([0xaa,00,0x2a,0xc8,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,0x9c])
cmd8500([0xaa,00,0x21,0x01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,0xcc])
cmd8500([0xaa,00,0x5f,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,0x09])

ser.close()


